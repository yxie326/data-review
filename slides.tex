\documentclass{beamer}

\mode<presentation>
{
    % Include the theme
    \usetheme{gatech}
    \setbeamercovered{transparent = 28}
}

\usepackage{braket}
\usepackage{caption}
\usepackage{siunitx}

\title{Data Review}

\author{Yi Xie}
\GTtoc{Table of contents}

\begin{document}

\GTtitle

\section{Overview}

    \begin{frame}{Intermolecular Energies}
        \begin{itemize}
            \item Supermolecular approach 
                $$E_{int} = E_{AB} - E_A - E_B$$
                \begin{itemize}
                    \item Straightforward, but cannot separate different types of interactions
                    \item Can adopt to different electronic structure methods
                    \item DFT-D3 with proper functional can be both cheap and accurate
                \end{itemize}
            \item Symmetry-Adapted Perturbation Theory
            \begin{itemize}
                \item Can give details about different types of interactions; important in understanding their nature 
                \item Not as cheap as DFT-D3
                \item SAPT0 is somewhat cheap, but does not include intramonomer correlation
            \end{itemize}
        \end{itemize}
    \end{frame}

    \begin{frame}{SAPT(DFT)}
        \begin{itemize}
            \item Attempt to inlude intramonomer correlation in a cheap way
            \item Replaces HF orbitals with KS orbitals
            \item Needs to consider orbital response for dispersion terms
            \item Exchange-dispersion term needs to be estimated from scaling 
            \item Investigate the accuracy and efficiency of SAPT(DFT)
        \end{itemize}
    \end{frame}

    \begin{frame}{Three-Body Interaction}
        \begin{itemize}
            \item Crucial in computing lattice energies
            \item DFT-D3 does not perform well for three-body interaction
            \item MP2.5 scales as $O(N^6)$, MP2 is $O(N^5)$ but lacks three-body dispersion
            \item Three-body dispersion can be implemented with SAPT(DFT) in $O(N^5)$
            \item Combine MP2 with SAPT(DFT) dispersion to model three-body interaction  
        \end{itemize}   
    \end{frame}

\section{SAPT(DFT) Implementation}
    
    \subsection{Theory}
             
        \begin{frame}{Idea of SAPT(DFT)}
            \begin{itemize}
                \item SAPT energy in orders of interaction and fluctuation potentials; $n$ denotes order in $V$ and $k,l$ for $W_A, W_B$
                $$H = F_A + F_B + V + W_A + W_B$$
                $$E_{int} = \sum_{n=1}^\infty \sum_{k=0}^\infty \sum_{l=0}^\infty \left(E_{pol}^{(nkl)} + E_{exch}^{(nkl)}\right)$$
                \item SAPT0: $n = 2, k = l = 0$, no intramonomer correlation, $O(N^5)$ cost
                \item Many-body SAPT: $k+l \geq 2$, $O(N^6)$ or higher cost
                \item SAPT(DFT): Use Kohn-Sham operator $K_{A,B}$ instead of Fock operator $F_{A,B}$, $O(N^5)$ cost
                \item Primitive SAPT(DFT) works well on 1st-order terms, but not 2nd-order terms (especially dispersion). Needs orbital response for them
            \end{itemize}
        \end{frame}

        \begin{frame}{Coupled Dispersion Energy}
            \begin{itemize}
                \item Uncoupled dispersion energy:
                \begin{eqnarray}
                    \nonumber
                    E_{disp,u}^{(2)} &=& -4\sum_{ia \in A,jb \in B} \frac{\left|\left(ia|jb\right)\right|^2}{\epsilon_{ij}^{ab}}\\ \nonumber
                    &=& -\frac{1}{2\pi}\int_0^\infty d\omega \int d\mathbf{r}_A d\mathbf{r}'_A d\mathbf{r}_B d\mathbf{r}'_B \\ \nonumber
                    & & \frac{1}{\left|\mathbf{r}_A-\mathbf{r}_B\right|}\frac{1}{\left|\mathbf{r}'_A-\mathbf{r}'_B\right|}\chi_0^A\left(\mathbf{r}_A,\mathbf{r}'_A|i\omega\right)\chi_0^B\left(\mathbf{r}_B,\mathbf{r}'_B|i\omega\right)
                \end{eqnarray}
                \item Kohn-Sham frequency-dependent density susceptibility (FDDS) does not reflect the correct response properties of the real electronic system
                \item Coupled FDDS from solving TDDFT equations:
                $$\boldsymbol{\chi} = \boldsymbol{\chi}_0 + \boldsymbol{\chi}_0 \mathbf{S}^{-1} \mathbf{W} \left( \mathbf{S} - \boldsymbol{\chi}_0 \mathbf{S}^{-1} \mathbf{W} \right)^{-1} \boldsymbol{\chi}_0$$
            \end{itemize}
        \end{frame}

        \begin{frame}{Dispersion Term}
            \begin{itemize}
                \item Pure ALDA kernel good for pure GGA functional, but not for hybrid functional 
                \item Exact exchange in $v_{xc} \rightarrow$ increased $\epsilon_{ij}^{ab} \rightarrow$ decreased $E_{disp}^{(2)}$ 
                $$E_{disp,u}^{(2)} = -4\sum_{ia \in A,jb \in B} \frac{\left|\left(ia|jb\right)\right|^2}{\epsilon_{ij}^{ab}}$$
                \item Hybrid ALDA kernel to compensate, or localized HF (LHF) exchange to avoid increase in $\epsilon_{ij}^{ab}$
                $$f_{xc} = \alpha f_{xc}^{HF} + (1-\alpha) f_{xc}^{ALDA}$$
            \end{itemize}            
        \end{frame}

        \begin{frame}{Equation for $E_{disp}^{(2)}$}
            \begin{itemize}
                \item Computing coupled FDDS:
                $$\boldsymbol{\chi} = \boldsymbol{\chi}_0' + \left( \boldsymbol{\chi}_0' \mathbf{S}^{-1} \mathbf{W} + \mathbf{K} \right) \left[ \mathbf{S} - \left( \boldsymbol{\chi}_0' \mathbf{S}^{-1} \mathbf{W} + \mathbf{K} \right) \right]^{-1} \boldsymbol{\chi}_0'$$
                $$\boldsymbol{\chi}_0' = \boldsymbol{\chi}_0 - \alpha \mathbf{K}_2 \left( \lambda \right)$$
                $$\mathbf{K} = \left[ - \alpha \mathbf{K}_1 \left( \lambda d\right) - \alpha \mathbf{K}_2 \left( \lambda d\right) + \alpha^2 \mathbf{K}_{21} \left( \lambda \right) \right] \left( \mathbf{R}^t \right)^{-1} \mathbf{S}$$
                \item $O(N^5)$ scaling is limited to forming  $\mathbf{K}_1$, $\mathbf{K}_2$ and $\mathbf{K}_{21}$
                \item Separates nontrivial and trivial parts of the code, also highly reduces need of disk I/O operations
                \item $E_{disp}^{(2)}$ from coupled FDDS:
                \begin{eqnarray}
                    \nonumber
                    E_{disp}^{(2)} &= -\frac{1}{2\pi}\int_0^\infty d\omega \int d\mathbf{r}_A d\mathbf{r}'_A d\mathbf{r}_B d\mathbf{r}'_B \\ \nonumber
                    & \frac{1}{\left|\mathbf{r}_A-\mathbf{r}_B\right|}\frac{1}{\left|\mathbf{r}'_A-\mathbf{r}'_B\right|}\chi^A\left(\mathbf{r}_A,\mathbf{r}'_A|i\omega\right)\chi^B\left(\mathbf{r}_B,\mathbf{r}'_B|i\omega\right)
                \end{eqnarray}
            \end{itemize}
        \end{frame}
        
        \begin{frame}{Exchange-Dispersion Term}
            \begin{itemize}
                \item Coupled exchange-dispersion requires storing 4-index tensors on disk
                \item Estimate from scaling uncoupled exchange-dispersion; Scale with ratio in dispersion term or with pre-fitted (with S22$\times$5) fixed factor 
                $$\tilde{E}^{(2)}_{exch-disp,r} = E^{(2)}_{exch-disp,u} \cdot \frac{E^{(2)}_{disp,r}}{E^{(2)}_{disp,u}}$$
                $$\tilde{E}^{(2)}_{exch-disp,r} = \alpha \cdot E^{(2)}_{exch-disp,u} (\alpha = 0.686361)$$
                \item The value above is fitted from $E_{exch-disp,u}^{(2)}$ with LHF orbitals
                \item Non-LHF orbitals have greater o-v gaps and smaller $E_{disp,u}^{(2)}$, needs to re-fit with non-LHF results
            \end{itemize}
        \end{frame}

        \begin{frame}{LHF vs non-LHF orbitals}
            \begin{figure}
            \centering
            \includegraphics[width=0.8\textwidth]{S66-terms.png}
            \caption{Hybrid vs. LHF values for each term for S66 data set ($E_{elst}^{(1)}$, $E_{exch}^{(1)}$, $E_{ind}^{(2)}$, $E_{exch-ind}^{(2)}$, $E_{disp,r}^{(2)}$, $E_{disp,u}^{(2)}$, $E_{exch-disp,u}^{(2)}$)} 
            \end{figure}        
        \end{frame}

        \begin{frame}{GRAC}
            \begin{itemize}
                \item (Hybrid-)GGA functionals does not have correct long-range behavior $v_{xc}(r) \rightarrow -1/r + (I_p + \epsilon_{\text{HOMO}})$
                \item Underestimates o-v gap as a consequence
                \item Functionals like LB94 have correct asymptotic behavior, but poor in bulk region
                \item Using gradient-regulated asymptotic correction (GRAC) scheme to connect PBE0 and LB94 with the switching function $f[g(\boldsymbol{r})]$:
                $$v_{xc}^{\text{GRAC}} = \left\{1-f[g(\boldsymbol{r})]\right\}v_{xc}^{\text{PBE0}} + f[g(\boldsymbol{r})] v_{xc}^{\text{LB94}}$$
                $$f[g(\boldsymbol{r})] = \left( 1+e^{-\alpha [g(\boldsymbol{r}) - \beta]} \right)^{-1}$$
                $$g(\boldsymbol{r}) = \frac{\left| \nabla \rho (\boldsymbol{r}) \right|}{\rho^{4/3}(\boldsymbol{r})}$$
            \end{itemize}
        \end{frame}        
        
        \begin{frame}{GRAC \& Long-Range Behavior}
            \begin{figure}
            \centering
            \includegraphics[width=0.65\textwidth]{GRAC.png}
            \caption{Radial densities $r^2\rho(r)$ of Ne atom (right) and errors compared to CCSD(T) density (left) for various xc potentials.\footnote{G. Jansen, WIREs Comput. Mol. Sci. \textbf{4}, 127 (2014).}} 
            \end{figure}
        \end{frame}

    \subsection{Results}
    
        \begin{frame}{Exchange-Dispersion Refitting}
            \begin{itemize}
                \item Need to fit the uncoupled $E_{exch-disp,r}^{(2)}$ with non-LHF orbitals on the coupled LHF orbital values (implemented in Molpro)
                \item Assuming coupled LHF and non-LHF orbital $E_{exch-disp,r}^{(2)}$ from the behavior of $E_{disp,r}^{(2)}$
                \item Exchange-related components depend heavily on distance between monomers, sets like S22$\times$5 and S66$\times$8 would be preferred
                \item Determine the scaling factor with S22$\times$5, validate with S66$\times$8 
            \end{itemize}
        \end{frame}

        \begin{frame}{S22$\times$5 Fitting Results}
            \begin{figure}
                \centering
                \includegraphics[width=0.45\textwidth]{S22x5-exchdisp.png}
                \caption{Scaling Factor = 0.770}
            \end{figure}   
        \end{frame}

        \begin{frame}{S66$\times$8 Validating Results}
            \begin{figure}
                \centering
                \includegraphics[width=0.45\textwidth]{S66x8-exchdisp.png}
            \end{figure}  
        \end{frame}

        \begin{frame}{Termwise results}
            \begin{itemize}
                \item Compared the SAPT(DFT)/aug-cc-pVTZ results of our code to SAPT(CCSD)/aug-cc-pVTZ results from Korona S2\footnote{T. Korona, Mol. Phys. \textbf{111}, 3705 (2013).}, which consists of 14 small dimers
                \item Also comparing the results for S66. SAPT(CCSD) results are not available, used SAPT2+3(CCD)$\delta$MP2/aug-cc-pVTZ as reference. Also added SAPT0/aug-cc-pVDZ, SAPT2+/aug-cc-pVDZ and SAPT2+(3)$\delta$MP2/aug-cc-pVTZ into comparison as side-reference. 
                \item Errors of each system with respect to reference shown as vertical lines
                \item Mean absolute error (MAE) and mean unsigned relative error (MURE) listed for S2
                \item Color scheme for S66 systems: Hydrogen-bonded (HB, red), mixed-influence (MX, green), dispersion-dominated (DD, blue)
            \end{itemize}
        \end{frame}

        \begin{frame}{Korona S2 Results}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{S2_1.png}
            \end{figure}  
        \end{frame}

        \begin{frame}{Korona S2 Results}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{S2_2.png}
            \end{figure}  
        \end{frame}

        \begin{frame}{S66 Results}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{S66_1.png}
            \end{figure}  
        \end{frame}

        \begin{frame}{S66 Results}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{S66_2.png}
            \end{figure}  
        \end{frame}

        \begin{frame}{Timing Performance}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{timingsystems.png}
                \caption{Dimer systems for timing: (a) Watson-Crick adenine-thymine complex, (b) RDX dimer, (c) C$_{60}$--buckycather complex.}
            \end{figure}
        \end{frame}

        \begin{frame}{Watson-Crick Adenine-Thymine}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{wcat.png}
            \end{figure}
        \end{frame}

        \begin{frame}{RDX Dimer}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{RDX.png}
            \end{figure}
        \end{frame}

        \begin{frame}{Comparison with LHF Approach}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{RDX_LHF.png}
            \end{figure}
        \end{frame}

        \begin{frame}{C$_{60}$--Buckycatcher Complex}
            \begin{itemize}
                \item $N_{bf} = 3012, N_{aux} = 9284$ with aug-cc-pVDZ basis set
                \item Using Intel i9-10980XE processor with 18 cores, completed entire calculation in 4.03 days
                \item 42.7 hours for $E_{disp}^{(2)}$; 20.1 hours for the $O(N^5)$ subroutines
                \item Cost of DFT and $E_{ind}^{(2)}$ still somewhat significant
            \end{itemize}
        \end{frame}

\section{Three-Body FDDS Dispersion}

    \subsection{Background}
    
        \begin{frame}{3B-69 Benchmark Set}
            \begin{itemize}
                \item Benchmark set for 3-body interaction energies
                \item 69 trimers extracted from 23 different molecular crystal structures (3 each)
                \item Used focal point approach to obtain CCSD(T) (and other wavefunction method) energies
                $$E = E^{HF}(aQZ) + \Delta E^{MP2}(aTZ/aQZ) + \Delta E^{CCSD(T)}(aDZ) $$   
                \item Assessing accuracy for various wavefunction and DFT methods 
                \item Recommended MP2.5 and SCS-MI-CCSD, both $O(N^6)$
                \item Trying to assess performance of MP2 + FDDS dispersion for 3B-69 systems
            \end{itemize}   
        \end{frame}

        \begin{frame}{3B-69 Wavefunctional Methods}
            \begin{figure}
                \centering
                \includegraphics[width=0.6\textwidth]{3B69_wfn.png}
            \end{figure}
        \end{frame}

        \begin{frame}{3B-69 DFT Methods}
            \begin{figure}
                \centering
                \includegraphics[width=0.8\textwidth]{3B69_DFT.png}
            \end{figure}
        \end{frame}

        \begin{frame}{New Set from X23}
            \begin{itemize}
                \item Sampling trimer geometries from X23 crystal structures
                \item Trying to include trimer with different intermolecular distances and alignment 
                \item Aiming to serve as a "three-body version" of S22$\times$5/S66$\times$8
                \item Distance: Geometry mean of 3 pairwise closest contact distance
                \item Alignment: Angles of the COM triangle; mainly looking at the greatest angle
            \end{itemize}
        \end{frame}

    \subsection{Results}

        \begin{frame}{3B-69 Systems}
            \begin{figure}
                \centering
                \includegraphics[width=0.7\textwidth]{3B69_systems.png}
            \end{figure}
        \end{frame}
        
        \begin{frame}{3B-69 Results}
            \begin{itemize}
                \item Total interaction energies in kcal/mol
                \item FDDS(aDZ) and FDDS(aTZ) correspond to estimated total IE with MP2 + FDDS
            \end{itemize}
            \begin{table}
                \centering
                \begin{tabular}{c c c c c c}
                    \hline
                    System & CCSD(T) & FDDS(aDZ) & FDDS(aTZ) & MP2 & MP2.5 \\ \hline
                    \textbf{1} & 0.181 & 0.207 & 0.210 & 0.161 & 0.179 \\ 
                    \textbf{2} & -0.122 & -0.069 & -0.065 & -0.178 & -0.143 \\
                    \textbf{3} & -0.922 & -0.905 & -0.904 & -0.937 & -0.913 \\
                    \textbf{4} & -0.089 & -0.003 & -0.003 & -0.239 & -0.151 \\
                    \textbf{5} & -0.027 & 0.002 & 0.003 & -0.061 & -0.023 \\ \hline
                \end{tabular}
            \end{table}
        \end{frame}
        
        \begin{frame}{3B-69 Results}
            \begin{itemize}
                \item Estimated 3-body dispersion energies comparison
                \item CCSD(T) corresponds to dispersion energy estimated by $E^{CCSD(T)} - E^{\text{MP2}}$
            \end{itemize}
            \begin{table}
                \centering
                \begin{tabular}{c c c c}
                    \hline
                    System & CCSD(T) & FDDS(aDZ) & FDDS(aTZ) \\ \hline
                    \textbf{1} & 0.020 & 0.046 & 0.049 \\ 
                    \textbf{2} & 0.056 & 0.109 & 0.113 \\
                    \textbf{3} & 0.015 & 0.032 & 0.033 \\
                    \textbf{4} & 0.150 & 0.236 & 0.242 \\
                    \textbf{5} & 0.034 & 0.063 & 0.064 \\ \hline
                \end{tabular}
            \end{table}
        \end{frame}

        \begin{frame}{Distance Dependence}
            \begin{figure}
                \centering
                \includegraphics[width=0.7\textwidth]{benzene_FDDS.png}
            \end{figure}
        \end{frame}

        \begin{frame}{Distance Dependence}
            \begin{figure}
                \centering
                \includegraphics[width=0.7\textwidth]{benzene_FDDS_log.png}
            \end{figure}
        \end{frame}

\end{document}
